<!DOCTYPE html>
  <html lang='en'>
    <head>
      <meta charset='utf-8'>
      <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'>      <title>Admin Tareas</title>

      <link rel='stylesheet' href='/pages/css/styles.css'>
      <link href='https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600&display=swap' rel='stylesheet'>
      <link rel='stylesheet' href='../../plugins/fontawesome-free/css/all.min.css'>
      <link rel='stylesheet' href='../../dist/css/adminlte.min.css'>
      <script src='https://use.fontawesome.com/releases/v6.3.0/js/all.js' crossorigin='anonymous'></script>
    </head>

    <body class='hold-transition sidebar-mini layout-fixed layout-footer-fixed'> 
      <!-- MODAL HISTORIAL DE TAREAS -->
      <div class='modal fade' id='modalHistorial' tabindex='-1' aria-hidden='true'>
        <div class='modal-dialog modal-lg modal-dialog-scrollable'>
          <div class='modal-content rounded-3 shadow'>
            <div class='modal-header'>
              <h5 class='modal-title mb-0'>
                <i class='fa-solid fa-clock-rotate-left mr-2'></i>
                Historial de cambios
              </h5>
              <!-- BS4 -->
              <button type='button' class='close' data-dismiss='modal' aria-label='Close'>
                <span aria-hidden='true'>&times;</span>
              </button>
              <!-- BS5 (alternativa):
              <button type='button' class='btn-close' data-bs-dismiss='modal' aria-label='Close'></button>
              -->
            </div>

            <div class='modal-body p-0'>
              <!-- Barra de filtro -->
              <div class='p-3 border-bottom'>
                <div class='input-group input-group-sm'>
                  <input id='buscarHistorial' type='text' class='form-control' placeholder='Filtrar por usuario, acción o estado...'>
                  <div class='input-group-append'>
                    <button id='btnLimpiarFiltro' class='btn btn-outline-secondary' type='button'>Limpiar</button>
                  </div>
                </div>
              </div>

              <!-- Timeline -->
              <ul class='timeline list-unstyled m-0' id='listaHistorial'>
                <!-- Se llena por JS -->
              </ul>
            </div>

            <div class='modal-footer justify-content-between'>
              <small class='text-muted' id='resumenHistorial'>0 eventos</small>
              <button type='button' class='btn btn-secondary' data-dismiss='modal'>Cerrar</button>
              <!-- BS5: data-bs-dismiss='modal' -->
            </div>
          </div>
        </div>
      </div>

      <div class='wrapper'> 

        <div id='loaderContainer' class='loader-overlay'>
          <div class='loader'></div>
        </div>

        <div id='sidebar-placeholder'></div>
    
        <app-navbar
          logout-url=''
          tooltip-text='Cerrar sesión'
          placement='bottom'
          icon-size='fa-2x'
          menu-icon-size='fa-2x'
          clear-keys='tab-activo, ultimaCardActiva'>
        </app-navbar>

        <div class='content-wrapper'> 
          <section class='content-header'>
            <div class='container-fluid'>
              <div class='row ml-2 mb-3'>
                <div id='btn-volver-placeholder' class='mr-2'></div>
                <div class='col-sm-6'>
                  <h1>Estructural Detalle</h1>
                </div> 
              </div>
            </div>
          </section>
 
          <section class='content'>
            <div class='card ml-3 mr-3'>
              <div class='card-header fadeInUp-animation'>
                <h3 class='card-title'>Proyecto 102365 | 44435685/105950039 LOTE CHRISTMAS 2 HUEVOS 40GR CON GADGET (P-000743)</h3>
              </div>
              <div class='card-body fadeInUp-animation'>
                <div class='row detalle-grid'>  
                  <div class='col-12 col-md-6 col-stack'>
                    <div class='scroll-desktop' style='height: 75vh; overflow-y: scroll;'>

                      <!-- ===== Encabezado: Diseño Estructural ===== -->
                      <div class='seccion-editable' data-seccion='diseno-estructural'>
                        <div class='card-header bg-danger text-white header-con-acciones'>
                          <h5 class='w-100 mb-0 text-center'>Diseño Estructural</h5>
                          <!-- Botones de acción (no alteran el centrado del título) -->
                          <div class='acciones-seccion'>
                            <button type='button' class='btn btn-sm btn-light btn-editar' data-seccion='diseno-estructural'>
                              <i class='fa fa-pen mr-1'></i> Editar
                            </button>
                            <button type='button' class='btn btn-sm btn-secondary btn-cancelar d-none' data-seccion='diseno-estructural'>
                              <i class='fa fa-rotate-left mr-1'></i> Cancelar
                            </button>
                            <button type='button' class='btn btn-sm btn-success btn-guardar d-none' data-seccion='diseno-estructural'>
                              <i class='fa fa-save mr-1'></i> Guardar
                            </button>
                          </div>
                        </div>
                      </div>

                      <div class='card-body'>  
                        <!-- ===== Tabla: Diseño Estructural (misma UI, ahora editable) ===== -->
                        <div class='table-responsive' data-seccion-target='diseno-estructural'>
                          <table class='table table-striped tabla-muestra'>
                            <tbody></tbody>
                          </table>
                        </div>

                        <!-- ===== Encabezado: Datos Troquel (se respeta tu UI) ===== -->
                        <div class='card bg-secondary text-white'>
                          <div class='card-header text-center header-con-acciones'>
                            <h5 class='w-100 mb-0'>Datos Troquel</h5>
                            <div class='acciones-seccion'>
                              <button type='button' class='btn btn-sm btn-light btn-editar' data-seccion='datos-troquel'>
                                <i class='fa fa-pen mr-1'></i> Editar
                              </button>
                              <button type='button' class='btn btn-sm btn-secondary btn-cancelar d-none' data-seccion='datos-troquel'>
                                <i class='fa fa-rotate-left mr-1'></i> Cancelar
                              </button>
                              <button type='button' class='btn btn-sm btn-success btn-guardar d-none' data-seccion='datos-troquel'>
                                <i class='fa fa-save mr-1'></i> Guardar
                              </button>
                            </div>
                          </div>
                        </div>

                        <!-- ===== Tabla: Datos Troquel ===== -->
                        <div class='table-responsive tabla-no-scroll' data-seccion-target='datos-troquel'>
                          <table class='table table-striped'>
                            <tbody></tbody>
                          </table>
                        </div>

                        <!-- ===== Encabezado: Propiedades ===== -->
                        <div class='card bg-secondary text-white my-4'>
                          <div class='card-header text-center header-con-acciones'>
                            <h5 class='w-100 mb-0'>Propiedades</h5>
                            <div class='acciones-seccion'>
                              <button type='button' class='btn btn-sm btn-light btn-editar' data-seccion='propiedades'>
                                <i class='fa fa-pen mr-1'></i> Editar
                              </button>
                              <button type='button' class='btn btn-sm btn-secondary btn-cancelar d-none' data-seccion='propiedades'>
                                <i class='fa fa-rotate-left mr-1'></i> Cancelar
                              </button>
                              <button type='button' class='btn btn-sm btn-success btn-guardar d-none' data-seccion='propiedades'>
                                <i class='fa fa-save mr-1'></i> Guardar
                              </button>
                            </div>
                          </div>
                        </div> 

                        <!-- ===== Tabla: Propiedades ===== -->
                        <div class='table-responsive tabla-no-scroll' data-seccion-target='propiedades'>
                          <table class='table table-striped'>
                            <tbody></tbody>
                          </table>
                        </div>

                      </div> <!-- /card-body -->
                    </div>
                  </div>
                  <div class='col-12 col-md-6 col-stack'>
                    <div class='card'>
                      <div class='card-header'>
                        <h4 class=''>
                          <i class="fa-solid fa-list-check"></i>
                          Tareas
                        </h4>
                      </div>
                      <div class='card-body'>
                        <ul class='list-group list-group-flush'>
                          <li class='list-group-item task-item' onclick='redireccionPagina("tareas_maqueta")'>
                            <span>Maqueta</span>
                            <i class='fas fa-box-open'></i>
                          </li>
                          <li class='list-group-item task-item' onclick='redireccionPagina("tareas_paletizado")'>
                            <span>Paletizado</span>
                            <i class='fas fa-pallet'></i>
                          </li>
                          <li class='list-group-item task-item' onclick='redireccionPagina("tareas_muestra_forrada")'>
                            <span>Muestra Forrada</span>
                            <i class='fas fa-layer-group'></i>
                          </li>
                          <li class='list-group-item task-item' onclick='redireccionPagina("tareas_revision_troqueles")'>
                            <span>Revisión Troqueles</span>
                            <i class='fas fa-crop'></i>
                          </li>
                          <li class='list-group-item task-item' onclick='redireccionPagina("tareas_trazados")'>
                            <span>Trazados</span>
                            <i class='fas fa-crop'></i>
                          </li>
                        </ul> 
                        <div class='mt-3 text-center'>
                          <button 
                            type='button'
                            class='btn btn-outline-secondary td-fonts'
                            data-toggle='modal'
                            data-target='#modalHistorial'>Ver historial<i class='fa-solid fa-clock-rotate-left ml-2'></i>
                          </button>
                        </div> 
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div> 
        
        <div id='toastArea' aria-live='polite' aria-atomic='true' class='toast-area'></div>
        <footer class='main-footer'>
          <strong>Cartonajes Bernabeú.</strong>
        </footer> 
        <aside class='control-sidebar control-sidebar-dark'></aside> 
      </div> 
      <script src='../../plugins/jquery/jquery.min.js'></script> 
      <script src='../../plugins/bootstrap/js/bootstrap.bundle.min.js'></script> 
      <script src='../../dist/js/adminlte.min.js'></script>
      <script src='/pages/js/scripts.js'></script> 
    </body>
  </html>
